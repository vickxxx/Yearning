(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-796e1a02"],{"24b9e":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Col",{attrs:{span:"5"}},[n("Card",[n("p",{attrs:{slot:"title"},slot:"title"},[n("Icon",{attrs:{type:"md-refresh"}}),e._v("\n                添加数据库\n            ")],1),n("div",{staticClass:"edittable-testauto-con"},[n("Form",{ref:"formValidate",attrs:{model:e.general,"label-width":100,rules:e.ruleInline}},[n("Form-item",{attrs:{label:"环境:",prop:"idc"}},[n("Select",{model:{value:e.general.idc,callback:function(t){e.$set(e.general,"idc",t)},expression:"general.idc"}},e._l(e.comList,(function(t){return n("Option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1),n("Form-item",{attrs:{label:"连接名称:",prop:"source"}},[n("Input",{attrs:{placeholder:"请输入"},model:{value:e.general.source,callback:function(t){e.$set(e.general,"source",t)},expression:"general.source"}})],1),n("Form-item",{attrs:{label:"数据库地址:",prop:"ip"}},[n("Input",{attrs:{placeholder:"请输入"},model:{value:e.general.ip,callback:function(t){e.$set(e.general,"ip",t)},expression:"general.ip"}})],1),n("Form-item",{attrs:{label:"端口:",prop:"port"}},[n("Input",{attrs:{placeholder:"请输入"},model:{value:e.general.port,callback:function(t){e.$set(e.general,"port",t)},expression:"general.port"}})],1),n("Form-item",{attrs:{label:"用户名:",prop:"username"}},[n("Input",{attrs:{placeholder:"请输入"},model:{value:e.general.username,callback:function(t){e.$set(e.general,"username",t)},expression:"general.username"}})],1),n("Form-item",{attrs:{label:"密码:",prop:"password"}},[n("Input",{attrs:{placeholder:"请输入",type:"password"},model:{value:e.general.password,callback:function(t){e.$set(e.general,"password",t)},expression:"general.password"}})],1),n("Form-item",{attrs:{label:"数据源类型:",prop:"is_query"}},[n("RadioGroup",{model:{value:e.general.is_query,callback:function(t){e.$set(e.general,"is_query",t)},expression:"general.is_query"}},[n("Radio",{attrs:{label:2}},[e._v("读写")]),n("Radio",{attrs:{label:1}},[e._v("读")]),n("Radio",{attrs:{label:0}},[e._v("写")])],1)],1),n("Button",{attrs:{type:"info"},on:{click:function(t){return e.testConnection()}}},[e._v("测试连接")]),n("Button",{staticStyle:{"margin-left":"5%"},attrs:{type:"success"},on:{click:function(t){return e.addConnection()}}},[e._v("确定")]),n("Button",{staticStyle:{"margin-left":"5%"},attrs:{type:"warning"},on:{click:function(t){return e.resetForm()}}},[e._v("重置")])],1)],1)])],1),n("Col",{staticClass:"padding-left-10",attrs:{span:"19"}},[n("Card",[n("p",{attrs:{slot:"title"},slot:"title"},[n("Icon",{attrs:{type:"md-apps"}}),e._v("\n                数据库详情表\n            ")],1),n("Input",{staticStyle:{width:"15%"},attrs:{placeholder:"请填写连接名",clearable:""},model:{value:e.query.source,callback:function(t){e.$set(e.query,"source",t)},expression:"query.source"}}),n("Select",{staticClass:"margin-left-10",staticStyle:{width:"15%"},attrs:{placeholder:"请填写环境"},model:{value:e.query.idc,callback:function(t){e.$set(e.query,"idc",t)},expression:"query.idc"}},e._l(e.comList,(function(t){return n("Option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1),n("Button",{staticClass:"margin-left-10",attrs:{type:"primary"},on:{click:e.queryData}},[e._v("查询")]),n("Button",{staticClass:"margin-left-10",attrs:{type:"warning"},on:{click:e.queryCancel}},[e._v("重置")]),n("div",{staticClass:"edittable-con-1"},[n("Table",{attrs:{columns:e.columns,data:e.table_data},scopedSlots:e._u([{key:"is_query",fn:function(t){var a=t.row;return[0===a.is_query?n("Tag",{attrs:{checkable:"",color:"primary"}},[e._v("写")]):e._e(),1===a.is_query?n("Tag",{attrs:{checkable:"",color:"success"}},[e._v("读")]):e._e(),2===a.is_query?n("Tag",{attrs:{checkable:"",color:"warning"}},[e._v("读写")]):e._e()]}},{key:"action",fn:function(t){var a=t.row;return[n("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"info",size:"small"},on:{click:function(t){return e.viewConnectionModal(a)}}},[e._v("详细信息\n                        ")]),n("Poptip",{attrs:{confirm:"",title:"删除数据源将会删除对应的所有工单信息,确定要删除吗？",transfer:""},on:{"on-ok":function(t){return e.delConnection(a)}}},[n("Button",{attrs:{type:"warning",size:"small"}},[e._v("删除")])],1)]}}])})],1),n("br"),n("Page",{attrs:{total:e.page_number,"show-elevator":"","page-size":10,current:e.current},on:{"on-change":e.getPageInfo,"update:current":function(t){e.current=t}}})],1)],1),n("Modal",{attrs:{width:500,okText:"保存"},on:{"on-ok":e.modifyBase},model:{value:e.is_open,callback:function(t){e.is_open=t},expression:"is_open"}},[n("h3",{staticStyle:{color:"#2D8CF0"},attrs:{slot:"header"},slot:"header"},[e._v("数据库连接信息")]),n("Form",{attrs:{"label-width":100,"label-position":"right"}},[n("FormItem",{attrs:{label:"环境"}},[n("Input",{attrs:{readonly:""},model:{value:e.edit_base_info.idc,callback:function(t){e.$set(e.edit_base_info,"idc",t)},expression:"edit_base_info.idc"}})],1),n("FormItem",{attrs:{label:"连接名称:"}},[n("Input",{attrs:{readonly:""},model:{value:e.edit_base_info.source,callback:function(t){e.$set(e.edit_base_info,"source",t)},expression:"edit_base_info.source"}})],1),n("FormItem",{attrs:{label:"数据库地址:"}},[n("Input",{model:{value:e.edit_base_info.ip,callback:function(t){e.$set(e.edit_base_info,"ip",t)},expression:"edit_base_info.ip"}})],1),n("FormItem",{attrs:{label:"端口:"}},[n("Input",{model:{value:e.edit_base_info.port,callback:function(t){e.$set(e.edit_base_info,"port",t)},expression:"edit_base_info.port"}})],1),n("FormItem",{attrs:{label:"用户名:"}},[n("Input",{model:{value:e.edit_base_info.username,callback:function(t){e.$set(e.edit_base_info,"username",t)},expression:"edit_base_info.username"}})],1),n("FormItem",{attrs:{label:"密码:"}},[n("Input",{attrs:{type:"password"},model:{value:e.edit_base_info.password,callback:function(t){e.$set(e.edit_base_info,"password",t)},expression:"edit_base_info.password"}})],1)],1)],1)],1)},r=[],o=(n("6b54"),n("2397"),n("d225")),i=n("b0b4"),s=n("4e2b"),c=n("308d"),l=n("6bb5"),u=(n("3b2b"),n("9ab4")),f=n("60a3"),p=n("028f");function d(e){var t=g();return function(){var n,a=Object(l["a"])(e);if(t){var r=Object(l["a"])(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(c["a"])(this,n)}}function g(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var b=function(e,t,n){var a=new RegExp("[`~!@#$^&*()={}':;',\\[\\]<>/?~！@#￥……&*（）——{}【】‘；：”“'。，、？]");a.test(t)?n(new Error("特殊字符仅可使用|与-")):n()},m=function(e,t,n){var a=new RegExp("[`?？^$]");a.test(t)?n(new Error("密码中不得含有? @ ^ $")):n()},_=function(e){Object(s["a"])(n,e);var t=d(n);function n(){var e;return Object(o["a"])(this,n),e=t.apply(this,arguments),e.columns=[{title:"连接名称",key:"source"},{title:"查询数据源",key:"is_query",slot:"is_query"},{title:"数据库地址",key:"ip"},{title:"环境",key:"idc"},{title:"操作",key:"action",width:300,slot:"action"}],e.ruleInline={idc:[{required:!0,message:"请选择对应环境",trigger:"change"}],source:[{required:!0,message:"请填写连接名称",trigger:"blur"},{validator:b,trigger:"blur"}],ip:[{required:!0,message:"请填写连接地址",trigger:"blur"}],username:[{required:!0,message:"请填写用户名",trigger:"blur"}],port:[{required:!0,message:"请填写端口",trigger:"blur"}],password:[{required:!0,message:"请填写密码",trigger:"blur"},{validator:m,trigger:"blur"}]},e.comList=[],e.edit_base_info={},e}return Object(i["a"])(n,[{key:"resetForm",value:function(){this.resetFields("formValidate")}},{key:"testConnection",value:function(){var e=this;this.$http.put("".concat(this.$config.url,"/management_db/test"),{ip:this.general.ip,username:this.general.username,password:this.general.password,port:parseInt(this.general.port)}).then((function(t){e.$config.notice(t.data)})).catch((function(t){e.$config.err_notice(e,t)}))}},{key:"addConnection",value:function(){var e=this,t=this.$refs["formValidate"];t.validate((function(n){n&&e.$http.post("".concat(e.$config.url,"/management_db"),{source:e.general.source,idc:e.general.idc,ip:e.general.ip,username:e.general.username,password:e.general.password,port:parseInt(e.general.port),is_query:e.general.is_query}).then((function(t){e.$config.notice(t.data)})).catch((function(t){e.$config.err_notice(e,t)})).finally((function(){t.resetFields(),e.getPageInfo(e.current)}))}))}},{key:"viewConnectionModal",value:function(e){this.is_open=!0,this.edit_base_info=Object.assign({},e)}},{key:"delConnection",value:function(e){var t=this,n=this.current;1===this.table_data.length&&(n-=1),this.$http.delete("".concat(this.$config.url,"/management_db?source=").concat(e.source)).then((function(e){t.$config.notice(e.data)})).catch((function(e){t.$config.err_notice(t,e)})).finally((function(){return t.getPageInfo(n)}))}},{key:"getPageInfo",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.$http.get("".concat(this.$config.url,"/management_db?page=").concat(t,"&con=").concat(JSON.stringify(this.query))).then((function(t){e.table_data=t.data.data,e.page_number=parseInt(t.data.page),e.comList=t.data.custom})).catch((function(t){e.$config.err_notice(e,t)}))}},{key:"modifyBase",value:function(){var e=this,t=Object.assign({},this.edit_base_info);t.port=parseInt(t.port),this.$http.put("".concat(this.$config.url,"/management_db"),{data:t}).then((function(t){e.$config.notice(t.data)})).catch((function(t){return e.$config.err_notice(e,t)})).finally((function(){return e.getPageInfo(e.current)}))}},{key:"queryData",value:function(){this.query.valve=!0,this.getPageInfo()}},{key:"queryCancel",value:function(){this.query.valve=!1,this.getPageInfo()}},{key:"mounted",value:function(){this.getPageInfo()}}]),n}(Object(f["b"])(p["a"]));_=Object(u["a"])([f["a"]],_);var h=_,v=h,y=(n("fb3d"),n("9afa"),n("2877")),k=Object(y["a"])(v,a,r,!1,null,null,null);t["default"]=k.exports},"3b2b":function(e,t,n){var a=n("7726"),r=n("5dbc"),o=n("86cc").f,i=n("9093").f,s=n("aae3"),c=n("0bfb"),l=a.RegExp,u=l,f=l.prototype,p=/a/g,d=/a/g,g=new l(p)!==p;if(n("9e1e")&&(!g||n("79e5")((function(){return d[n("2b4c")("match")]=!1,l(p)!=p||l(d)==d||"/a/i"!=l(p,"i")})))){l=function(e,t){var n=this instanceof l,a=s(e),o=void 0===t;return!n&&a&&e.constructor===l&&o?e:r(g?new u(a&&!o?e.source:e,t):u((a=e instanceof l)?e.source:e,a&&o?c.call(e):t),n?this:f,l)};for(var b=function(e){e in l||o(l,e,{configurable:!0,get:function(){return u[e]},set:function(t){u[e]=t}})},m=i(u),_=0;m.length>_;)b(m[_++]);f.constructor=l,l.prototype=f,n("2aba")(a,"RegExp",l)}n("7a56")("RegExp")},"9afa":function(e,t,n){"use strict";n("db1d")},aae3:function(e,t,n){var a=n("d3f4"),r=n("2d95"),o=n("2b4c")("match");e.exports=function(e){var t;return a(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==r(e))}},db1d:function(e,t,n){},f972:function(e,t,n){},fb3d:function(e,t,n){"use strict";n("f972")}}]);
//# sourceMappingURL=chunk-796e1a02.c306655e.js.map